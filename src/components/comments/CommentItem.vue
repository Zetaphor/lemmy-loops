<template>
  <div class="relative bg-gray-800 rounded-md p-4 mb-0.5 mt-0.5" :style="{ marginLeft: item.comment.depth * 5 + 'px' }">
    <div class="depth-indicator absolute top-0 left-0 bottom-0"
      :style="{ backgroundColor: depthColors[item.comment.depth - 1] }"></div>
    <div>

      <div>
        <div class="text-sm inline-flex items-center">
          <div class="avatar mr-2" v-if="item.creator.avatar.length">
            <div class="w-6 rounded-full">
              <img :src="item.creator.avatar" />
            </div>
          </div>
          <p class="text-sm">
            <span class="text-gray-300">{{ item.creator.name }}</span>
            <span class="text-gray-400">@{{ item.creator.actor_domain }}</span>
          </p>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10" class="h-4 w-4">
            <circle cx="5" cy="5" r="2" class="fill-current text-gray-600" />
          </svg>
          <p class="flex-grow-0 text-sm">{{ item.comment.published }}</p>
        </div>
      </div>
      <Markdown :source="item.comment.content" />
      <div>
        <div class="text-sm inline-flex items-center">
          <p class="flex-grow-0 text-sm ml-1">{{ item.counts.score }}pts</p>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 0 10 10" class="h-4 w-4">
            <circle cx="5" cy="5" r="2" class="fill-current text-gray-600" />
          </svg>
          <svg v-if="item.counts.my_vote === 1" xmlns="http://www.w3.org/2000/svg" viewBox="10 0 70 90"
            class="stroke-orange-300 fill-orange-300 w-4 h-4">
            <path
              d="M50 85.5a13 13 0 0 1-13-13 13 13 0 0 1 22.2-9 13 13 0 0 1 3.8 9 13 13 0 0 1-13 13Zm0-11.3c3 0-2 2.2.2 0 2.1-2 .8 3 .8 0 0-2.9 2.9 2 .8 0-2.1-2.2-1.8.2-4.8.2s5.5-2.4 3.4-.3c-2.2 2.1-.7-5-.7-2s-.5-.9 1.6 1.2c2.1 2-4.3.9-1.3.9Zm-21.7-12a5 5 0 0 1-3.5-1.5l-8-8c-1.9-2-1.6-4.9 0-7L38.6 24l8-8c1.9-2 5-2 7 0l8 8L83 45.7c2 2 2 5 0 7l-8 8a5 5 0 0 1-3.3 1.4h-.1a5 5 0 0 1-3.6-1.4L50 42.5 31.9 60.7a5 5 0 0 1-3.6 1.5Zm0-1.6c1 0 .7-2.5 1.4-3.2L49.4 41c.3-.3.8-.3 1.1 0L72 59.2c.7.6-1.2 1.4-.3 1.4.8 0 1.7-.3 2.4-1l7.9-8c1.3-1.3-9.3 10.7-10.6 9.4L53.7 44.5 49 42.1l-5.4-19.6c-1.3-1.3 5.9-3.7 4.5-2.4l.8 22-20.5 19C27 62.5 16.7 50.2 18 51.5l8 8a3 3 0 0 0 2.3 1Z" />
          </svg>
          <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="10 0 70 90"
            class="stroke-orange-300 fill-orange-300 w-4 h-4">
            <path
              d="M50.02,85.502c-3.441,0-6.825-1.397-9.251-3.801s-3.808-5.757-3.808-9.139s1.382-6.736,3.808-9.14   s5.81-3.773,9.251-3.773c3.413,0,6.768,1.37,9.194,3.773s3.836,5.758,3.836,9.14s-1.41,6.735-3.836,9.139   S53.433,85.502,50.02,85.502L50.02,85.502z M50.02,83.938c2.989,0,5.951-1.258,8.066-3.354c2.115-2.067,3.356-5.059,3.356-8.021   c0-2.963-1.241-5.926-3.356-8.021c-2.115-2.097-5.077-3.326-8.066-3.326c-2.99,0-6.007,1.229-8.123,3.326   c-2.115,2.096-3.356,5.059-3.356,8.021c0,2.962,1.241,5.953,3.356,8.021C44.013,82.68,47.03,83.938,50.02,83.938L50.02,83.938z    M28.331,62.165c-1.269,0-2.538-0.475-3.525-1.453l-7.925-7.993c-1.946-1.958-1.721-4.919-0.084-6.988   c0.028-0.028,0.056-0.056,0.084-0.056l21.604-21.716l7.954-7.993c1.918-1.957,5.104-1.957,7.05,0l7.926,7.993l21.632,21.716   c1.946,1.957,1.946,5.086,0,7.044l-7.953,7.993c-0.931,0.95-2.2,1.397-3.44,1.426c-0.028,0-0.057,0.027-0.085,0.027   c-1.27,0-2.566-0.475-3.525-1.453L49.963,42.517L31.885,60.712C30.897,61.69,29.628,62.165,28.331,62.165L28.331,62.165z    M28.331,60.6c0.875,0,1.721-0.335,2.397-1.006l18.671-18.726c0.282-0.307,0.846-0.307,1.128,0l18.67,18.726   c0.648,0.671,1.522,0.979,2.369,0.979c0.874,0,1.721-0.308,2.397-0.979l7.925-7.993c1.354-1.342,1.354-3.466,0-4.835L60.286,25.049   h0.027l-7.981-7.965c-1.325-1.341-3.412-1.341-4.766,0l-7.954,7.965l-21.548,21.66c-1.241,1.593-1.41,3.55-0.057,4.892l7.954,7.993   C26.611,60.265,27.485,60.6,28.331,60.6L28.331,60.6z" />
          </svg>
          <p class="flex-grow-0 ml-0.5 mr-1 text-xs">{{ item.counts.upvotes }}</p>

          <svg v-if="item.counts.my_vote === -1" xmlns="http://www.w3.org/2000/svg"
            class="stroke-blue-300 fill-blue-300 w-4 h-4" viewBox="10 0 70 90">
            <path
              d="M50 14.5a12.9 12.9 0 1 0 0 25.9 13 13 0 0 0 13-13 13 13 0 0 0-3.8-9 13.2 13.2 0 0 0-9.2-3.9Zm-9.4 8.2c3 0 8.5 3.2 10.6 5.3 2.1 2.1 9.8-5 9.8-2s.3-4-1.8-1.9a70.3 70.3 0 0 1-20.8 6.4c-3 0 3.9 4.6 1.8 2.5-2.1-2 14.2-1.7 14.2-4.7S39.8 21.5 42 19.4c2.1-2.1-4.3 3.3-1.3 3.3ZM28.3 37.8a5 5 0 0 0-3.5 1.5l-8 8c-1.9 2-1.6 5 0 7l21.7 21.8 8 8a5 5 0 0 0 7 0l8-8L83 54.3c2-2 2-5 0-7l-8-8a5 5 0 0 0-3.3-1.4h-.1a5 5 0 0 0-3.6 1.4L50 57.5 31.9 39.3a5 5 0 0 0-3.6-1.5Zm12 21.2c.8 0 1 7.5 1.6 8.2l14.2-6.8c-.1 3-2.1 15.5-1.8 15.2l10.5-19c.6-.7-4 1.6-3.1 1.6.9 0-6.2 10-5.5 10.6l2.9 7.5c1.4 1.4 24.1-24.4 22.8-23L60.3 74.8l-6.7-14.6L49.3 80c-1.3 1.4 10-12.8 8.7-14.2L39.6 75l8.8 3c-1.2-1.5 2.2-4.8 3.6-6.2l7.6-11.6c.7-.7-20.2-1-19.4-1Z" />
          </svg>
          <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="10 0 70 90"
            class="stroke-blue-300 fill-blue-300 w-4 h-4">
            <path
              d="M50.02,14.509c-3.441,0-6.825,1.397-9.251,3.801c-2.426,2.375-3.808,5.729-3.808,9.139   c0,3.382,1.382,6.735,3.808,9.139c2.426,2.403,5.81,3.773,9.251,3.773c3.413,0,6.768-1.37,9.194-3.773   c2.426-2.404,3.836-5.757,3.836-9.139c0-3.41-1.41-6.764-3.836-9.139C56.788,15.906,53.433,14.509,50.02,14.509L50.02,14.509z    M50.02,16.074c2.989,0,5.951,1.229,8.066,3.326s3.356,5.086,3.356,8.049c0,2.962-1.241,5.897-3.356,7.993   s-5.077,3.326-8.066,3.326c-2.99,0-6.007-1.229-8.123-3.326c-2.115-2.096-3.356-5.031-3.356-7.993c0-2.963,1.241-5.953,3.356-8.049   C44.013,17.304,47.03,16.074,50.02,16.074L50.02,16.074z M28.331,37.846c-1.269,0-2.538,0.475-3.525,1.453l-7.925,7.993   c-1.946,1.957-1.721,4.919-0.084,6.988c0.028,0.027,0.056,0.027,0.084,0.056l21.604,21.716l7.954,7.993   c1.918,1.929,5.104,1.929,7.05,0l7.926-7.993l21.632-21.716c1.946-1.957,1.946-5.115,0-7.043l-7.953-7.993   c-0.931-0.95-2.2-1.397-3.44-1.425c-0.028,0-0.057-0.028-0.085-0.028c-1.27,0-2.566,0.475-3.525,1.453L49.963,57.494L31.885,39.299   C30.897,38.321,29.628,37.846,28.331,37.846L28.331,37.846z M28.331,39.383c0.875,0.028,1.721,0.363,2.397,1.034l18.671,18.725   c0.282,0.308,0.846,0.308,1.128,0l18.67-18.725c0.648-0.671,1.522-1.006,2.369-1.006c0.874,0,1.721,0.335,2.397,1.006l7.925,7.965   c1.354,1.369,1.354,3.493,0,4.835L60.286,74.934l0.027,0.028l-7.981,7.965c-1.325,1.342-3.412,1.342-4.766,0l-7.954-7.993   L18.065,53.302c-1.241-1.593-1.41-3.578-0.057-4.919l7.954-7.965C26.611,39.747,27.485,39.383,28.331,39.383L28.331,39.383z" />
          </svg>
          <p class="flex-grow-0 ml-0.5 text-xs">{{ item.counts.downvotes }}</p>

          <svg v-if="item.comment.saved" viewBox="10 -5 75 100" class="stroke-yellow-300 fill-yellow-300 h-4 w-4 ml-2"
            xmlns="http://www.w3.org/2000/svg">
            <path
              d="M 25.5 61.5 L 23.3 82.6 C 22.94 85.703 25.376 88.421 28.5 88.4 C 29.2 88.4 29.9 88.2 30.6 87.9 L 50 79.2 L 69.4 87.8 C 71.1 88.6 73.1 88.4 74.6 87.3 C 76.114 86.195 76.916 84.362 76.7 82.5 L 74.5 61.4 L 88.7 45.6 C 89.995 44.241 90.42 42.272 89.8 40.5 C 89.2 38.7 87.8 37.4 85.9 37 L 65.2 32.6 L 54.5 14.3 C 53.587 12.677 51.862 11.68 50 11.7 C 48.1 11.7 46.4 12.7 45.5 14.3 L 34.9 32.7 L 14.2 37.1 C 12.374 37.497 10.892 38.827 10.3 40.6 C 9.68 42.372 10.105 44.341 11.4 45.7 L 25.5 61.5 Z M 13.918 45.203 C 14.018 44.903 27.535 59.968 28.435 59.768 L 36.4 35.9 C 36.9 35.8 54.179 36.615 54.379 36.215 L 48.5 16.1 C 49 15.3 49.7 15.2 50 15.2 C 50.3 15.2 46.801 15.618 47.201 16.418 C 47.201 16.418 11.438 59.235 45.391 53.899 L 45.019 62.899 L 46.111 56.399 L 47.813 77.64 L 71.465 60.604 C 72.756 60.82 86.864 42.448 86.031 43.458 C 85.99 43.508 85.946 43.555 85.9 43.6 L 71.4 59.7 C 71.1 60.1 49.609 75.786 49.709 76.186 L 71.662 85.778 C 71.762 86.678 72.8 84.2 72.6 84.4 C 72.4 84.6 71.7 84.9 70.9 84.6 L 50.8 75.7 C 50.3 75.5 49.8 75.5 49.4 75.7 L 29.3 84.6 C 28.5 85 29.884 86.238 29.684 86.038 C 29.484 85.838 47.793 77.447 47.893 76.547 L 51.433 56.087 C 51.533 55.587 44.335 53.747 44.035 53.447 L 13.9 43.4 C 13.3 42.7 13.818 45.503 13.918 45.203 Z" />
          </svg>
        </div>
      </div>
    </div>
  </div>
</template>

<style scoped>
.depth-indicator {
  width: 3px;
}
</style>

<script setup>
import { ref } from 'vue';
import Markdown from '@/components/Markdown.vue';

defineProps(['item'])

const depthColors = [
  '#AA0000', // Red
  '#007F00', // Green
  '#00007F', // Blue
  '#AAAA00', // Yellow
  '#AA00AA', // Magenta
  '#007F7F', // Cyan
  '#AA7700', // Orange
  '#550055', // Purple
  '#005500', // Dark Green
  '#AA8093', // Pink
]
</script>
